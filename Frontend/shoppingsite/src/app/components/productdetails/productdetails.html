<div class="container my-5" *ngIf="product">
  <div class="row">

    <!-- Product Image -->
    <div class="col-md-5">
      <img [src]="selectedImage"
           class="img-fluid rounded shadow-sm d-block mx-auto"
           alt="{{ product.title }}"
           style="width: 100%; max-width: 400px; height: 400px; object-fit: contain;">

      <div class="mt-3 d-flex flex-wrap gap-2">
        <img *ngFor="let img of product.images"
             [src]="img"
             class="img-thumbnail"
             width="70"
             height="70"
             alt="Extra image"
             (click)="setMainImage(img)" 
             [class.border-primary]="selectedImage === img"
             style="cursor: pointer;">
      </div>
    </div>

    <!-- Product Details -->
    <div class="col-md-7">
      <h2 class="fw-bold">{{ product.title }}</h2>
      <p class="text-muted">{{ product.description }}</p>

      <h4 class="text-success mb-3">{{ product.price | currency:'EUR' }}</h4>

      <!-- Stock -->
      <p>
        <strong>Status:</strong>
        <span class="badge" [ngClass]="product.stock > 0 ? 'bg-success' : 'bg-danger'">
          {{ product.stock > 0 ? 'In Stock ('+product.stock+')' : 'Out of Stock' }}
        </span>
      </p>

      <!-- product Info -->
      <ul class="list-unstyled">
        <li><strong>Category:</strong> {{ product.category }}</li>
        <li><strong>Brand:</strong> {{ product.brand }}</li>
        <li><strong>SKU:</strong> {{ product.sku }}</li>
        <li><strong>Weight:</strong> {{ product.weight }} g</li>
        <li><strong>Dimensions:</strong> {{ product.dimensions.width }} x {{ product.dimensions.height }} x {{ product.dimensions.depth }} cm</li>
        <li><strong>Warranty:</strong> {{ product.warrantyInformation }}</li>
        <li><strong>Shipping:</strong> {{ product.shippingInformation }}</li>
        <li><strong>Return Policy:</strong> {{ product.returnPolicy }}</li>
      </ul>

      <!-- Add to Cart -->
      <div class="d-flex align-items-center gap-2 mt-3">
        <input type="number" [(ngModel)]="quantity" class="form-control w-25" min="1" [max]="product.stock">
        <button class="btn btn-primary"
                (click)="addToCart(product)"
                [disabled]="product.stock === 0">
          Add to Cart
        </button>
      </div>
    </div>
  </div>

  <hr class="my-5">

  <!-- Reviews Section -->
  <div>
    <h4 class="mb-3">Customer Reviews</h4>
    <div *ngIf="product.reviews && product.reviews.length > 0; else noReviews">
      <div *ngFor="let review of product.reviews" class="border-bottom py-3">
        <p class="mb-1">
          <strong>{{ review.reviewerName }}</strong>
          <span class="text-warning ms-2">
            <ng-container *ngFor="let i of [1,2,3,4,5]">
              <i class="fa" [ngClass]="i <= review.rating ? 'fa-star' : 'fa-star-o'"></i>
            </ng-container>
          </span>
        </p>
        <p class="text-muted small mb-1">{{ review.date | date }}</p>
        <p>{{ review.comment }}</p>
      </div>
    </div>
    <ng-template #noReviews>
      <p class="text-muted">No reviews yet.</p>
    </ng-template>
  </div>
</div>
